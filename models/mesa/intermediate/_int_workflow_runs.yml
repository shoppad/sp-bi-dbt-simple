version: 2
models:
  - name: int_workflow_runs
    columns:
      - name: workflow_run_id
        tests:
          - not_null
          - unique
      - name: workflow_id
        tests:
          - not_null
          - relationships_proportion:
              to: ref('stg_workflows')
              field: workflow_id
              warn_if: '>1'
              error_if: '>5'
      - name: shop_subdomain
        tests:
          - not_null
          - relationships:
              to: ref('int_shops')
              field: shop_subdomain
      - name: workflow_run_at_utc
        tests:
          - not_null
      - name: workflow_run_at_pt
        tests:
          - not_null
      - name: workflow_run_on_pt
        tests:
          - not_null
      - name: run_status
        tests:
          - not_null
      - name: unbillable_reason
      - name: is_free_workflow
        tests:
          - not_null
      - name: is_billable
        tests:
          - not_null
      - name: workflow_name
        tests:
          - not_null
      - name: source_app
        tests:
          - not_null
      - name: integration_key
        tests:
          - not_null
      - name: child_failure_count
        tests:
          - not_null
      - name: updated_at
        tests:
          - not_null
      - name: is_test_run
        tests:
          - not_null
      - name: is_workflow_hard_deleted
        tests:
          - not_null
      - name: executed_step_count
        tests:
          - not_null
      - name: is_successful
        tests:
          - not_null
      - name: destination_app
        tests:
          - not_null
      - name: source_destination_pair
        tests:
          - not_null

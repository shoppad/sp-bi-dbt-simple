version: 2
models:
  - name: mesa_shop_monthly_cohort_performance
    description:
      "This model calculates the funnel performance of the monthly cohorts
      of Shops.

      "
    columns:
      - name: cohort_month
        description: The month of the Shop's first app installation.
        tests:
          - not_null
          - unique
      - name: cohort_size
        description: The number of users who first installed in the given month.
        tests:
          - not_null
      - name: total_ltv_revenue
        description:
          The total revenue generated by users who first installed in the given
          week.
        tests:
          - not_null
      - name: has_a_workflow_count
        description:
          The number of users who first installed in the given month and have
          a workflow.
        tests:
          - not_null
      - name: has_enabled_a_workflow_count
        description:
          The number of users who first installed in the given month and have
          enabled a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.9
      - name: is_activated_count
        description:
          The number of users who first installed in the given month and are
          activated.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.9
      - name: has_a_workflow_pct
        description:
          The percentage of users who first installed in the given month and
          have a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: workflow_enabling_incremental_pct
        description:
          The percentage of users who first installed in the given month and
          have enabled a workflow, compared to only having a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: workflow_enabling_cohort_pct
        description:
          The percentage of users who first installed in the given month and
          have enabled a workflow, compared to the cohort size.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: activation_cohort_pct
        description:
          The percentage of users who first installed in the given month and
          are activated, compared to the cohort size.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: activation_incremental_pct
        description:
          The percentage of users who first installed in the given month and
          are activated, compared to only enabling a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: lifetime_value_installed
        description:
          The average revenue generated by users who first installed in the
          given month.
        tests:
          - not_null
      - name: lifetime_value_has_a_workflow
        description:
          The average revenue generated by users who first installed in the
          given month and have a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: lifetime_value_enabled_workflow
        description:
          The average revenue generated by users who first installed in the
          given month and have enabled a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: lifetime_value_activated
        description:
          The average revenue generated by users who first installed in the
          given month and are activated.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5

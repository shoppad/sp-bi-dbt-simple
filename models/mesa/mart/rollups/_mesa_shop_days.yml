version: 2
models:
  - name: mesa_shop_days
    columns:
      - name: shop_subdomain
        tests:
          - not_null
          - relationships:
              to: ref('shops')
              field: shop_subdomain
      - name: dt
        tests:
          - not_null
          - dbt_utils.accepted_range:
              max_value: "getdate()"
      - name: workflow_runs_success_count
        tests:
          - not_null
      - name: workflow_success_percent
        tests:
          - not_null
      - name: billed_count
        tests:
          - not_null
      - name: daily_usage_revenue
        tests:
          - not_null
      - name: first_installed_at_pt
        tests:
          - not_null
      - name: is_active
        tests:
          - not_null
      - name: workflow_runs_rolling_thirty_day_count
        tests:
          - not_null
      - name: daily_plan_revenue
        tests:
          - not_null
      - name: inc_amount
        tests:
          - not_null
        meta:
          metabase.semantic_type: type/Currency
      - name: WORKFLOW_RUNS_COUNT
        tests:
          - not_null
      - name: MESA_SHOP_DAYS_ID
        tests:
          - not_null
          - unique
    tests:
      - dbt_expectations.expect_compound_columns_to_be_unique:
          column_list: ["dt", "shop_subdomain"]

version: 2
models:
  - name: stg_mesa_billing_accounts
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('stg_shops')
    columns:
      - name: SHOP_subdomain
        tests:
          - unique
          - not_null
      - name: BILLING_METHOD_NAME
        tests:
          - not_null
          - accepted_values:
              values: ["shopify", "chargebee"]
      - name: BILLING_OVERAGE_BUCKET_START_DATE_PT
      - name: BILLING_OVERAGE_BUCKET_END_DATE_PT
      - name: BILLING_OVERAGE_BYPASS_UNTIL
        tests:
          - dbt_utils.not_accepted_values:
              values: ["null"]
      - name: BILLING_OVERAGE_LAST_COUNT
      - name: DAILY_PLAN_REVENUE
      - name: BALANCE_USED
      - name: SHOPIFY_ID
      - name: PLAN_PRICE
      - name: PLAN_USED
      - name: STATUS
      - name: PERCENT_COMPLETE
      - name: BILLING_ON_PT
      - name: PLAN_NAME
      - name: PERCENT_USED
      - name: OVERLIMIT_DATE_PT
      - name: BALANCE_REMAINING
      - name: START_DATE_PT
      - name: END_DATE_PT
      - name: CREATED_AT_PT
      - name: TRIAL_ENDS_PT
      - name: CHARGEBEE_ID
      - name: PLAN_TYPE
      - name: DAYS_COMPLETE
      - name: PLAN_ID
      - name: PLAN_INTERVAL
      - name: TRIAL_DAYS
      - name: BILLING_UPDATED_AT_PT

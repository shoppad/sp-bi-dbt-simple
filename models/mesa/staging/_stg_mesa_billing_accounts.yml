version: 2
models:
  - name: stg_mesa_billing_accounts
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('stg_shops')
    columns:
      - name: SHOP_subdomain
        tests:
          - unique
          - not_null
      - name: BILLING_METHOD_NAME
        tests:
          - not_null
          - accepted_values:
              values: ['shopify', 'chargebee']
      - name: BILLING_OVERAGE_BUCKET_START_DATE_PT
      - name: BILLING_OVERAGE_BUCKET_END_DATE_PT
      - name: BILLING_OVERAGE_BYPASS_UNTIL
        tests:
          - dbt_utils.not_accepted_values:
              values: ['null']
      - name: BILLING_OVERAGE_LAST_COUNT
      - name: BILLING_PLAN_DAYS_COMPLETE
      - name: BILLING_PLAN_ID
      - name: BILLING_PLAN_PERCENT_COMPLETE
      - name: BILLING_PLAN_PERCENT_USED
      - name: BILLING_PLAN_START_DATE_PT
      - name: BILLING_PLAN_END_DATE_PT
      - name: BILLING_PLAN_STATUS
      - name: BILLING_PLAN_USED
      - name: BILLING_PLAN_NAME
      - name: BILLING_METHOD_SHOPIFY_ID
      - name: BILLING_PLAN_TRIAL_DAYS
      - name: BILLING_PLAN_TRIAL_ENDS_PT
      - name: BILLING_PLAN_UPDATED_AT_PT
      - name: BILLING_PLAN_BILLING_ON_PT
      - name: BILLING_PLAN_OVERLIMIT_DATE_PT
      - name: BILLING_PLAN_BALANCE_REMAINING
      - name: BILLING_METHOD_CHARGEBEE_ID
      - name: BILLING_PLAN_VOLUME
      - name: BILLING_PLAN_INTERVAL
      - name: BILLING_PLAN_PRICE
      - name: BILLING_PLAN_CREATED_AT_PT
      - name: BILLING_PLAN_BALANCE_USED
      - name: BILLING_PLAN_TYPE
      - name: DAILY_PLAN_REVENUE

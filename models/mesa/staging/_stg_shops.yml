version: 2
models:
  - name: stg_shops
    description: '{{ doc("staging_shops") }}'
    tests:
      - dbt_expectations.expect_table_row_count_to_be_between:
          min_value: 4000

    columns:
      - name: shop_subdomain
        tests:
          - not_null
          - unique

      - name: status
      - name: billing
      - name: scopes
      - name: themes
      - name: entitlements
      - name: referral
      - name: method
      - name: meta
      - name: handle
      - name: timestamp
      - name: first_installed_at_pt
        tests:
          - not_null
      - name: latest_installed_at_pt
        tests:
          - not_null
      - name: mongoid
      - name: uuid
      - name: __hevo__marked_deleted
      - name: analytics
      - name: webhooks
      - name: _created_at
      - name: authtoken
      - name: usage
      - name: __hevo__ingested_at
      - name: __hevo__loaded_at
      - name: wizard
      - name: config
      - name: shopify
      - name: messages
      - name: account
      - name: metabase
      - name: schema
      - name: group
      - name: __hevo__database_name
      - name: _id
      - name: __hevo_id
      - name: uninstalled_at_pt
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: minutes_until_uninstall
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
version: 2
models:
  - name: mesa_shop_weekly_cohort_performance
    description:
      "This model calculates the funnel performance of the weekly cohorts
      of Shop installs.

      "
    columns:
      - name: cohort_week
        description: The week of the Shop's first app installation.
        tests:
          - not_null
          - unique
      - name: cohort_size
        description: The number of users who first installed in the given week.
        tests:
          - not_null
      - name: total_ltv_revenue
        description:
          The total revenue generated by users who first installed in the given
          week.
        tests:
          - not_null
      - name: has_a_workflow_count
        description:
          The number of users who first installed in the given week and have
          a workflow.
        tests:
          - not_null
      - name: has_enabled_a_workflow_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.9
      - name: is_activated_count
        description:
          The number of users who first installed in the given week and are
          activated.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.9
      - name: has_a_workflow_pct
        description:
          The percentage of users who first installed in the given week and
          have a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: workflow_enabling_incremental_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow, compared to only having a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: workflow_enabling_cohort_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow, compared to the cohort size.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: activation_cohort_pct
        description:
          The percentage of users who first installed in the given week and
          are activated, compared to the cohort size.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: activation_incremental_pct
        description:
          The percentage of users who first installed in the given week and
          are activated, compared to only enabling a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: lifetime_value_installed
        description:
          The average revenue generated by users who first installed in the
          given week.
        tests:
          - not_null
      - name: lifetime_value_has_a_workflow
        description:
          The average revenue generated by users who first installed in the
          given week and have a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: lifetime_value_enabled_workflow
        description:
          The average revenue generated by users who first installed in the
          given week and have enabled a workflow.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: lifetime_value_activated
        description:
          The average revenue generated by users who first installed in the
          given week and are activated.
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.5
      - name: is_activated_count
        description:
          The number of users who first installed in the given week and are
          activated.
      - name: activation_incremental_pct
        description:
          The percentage of users who first installed in the given week and
          are activated, compared to only enabling a workflow.
      - name: has_workflow_enabled_first_day_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first day.
      - name: has_workflow_enabled_first_year_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first year.
      - name: has_workflow_enabled_first_three_days_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first three days.
      - name: has_workflow_enabled_first_week_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first week.
      - name: has_workflow_enabled_first_six_months_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first six months.
      - name: has_workflow_enabled_first_week_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first week.
      - name: has_workflow_enabled_first_two_weeks_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first two weeks.
      - name: has_workflow_enabled_first_month_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first month.
      - name: has_workflow_enabled_first_day_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first day.
      - name: has_workflow_enabled_first_two_months_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first two months.
      - name: has_workflow_enabled_first_three_days_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first three days.
      - name: has_workflow_enabled_first_three_months_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first three months.
      - name: has_workflow_enabled_first_two_days_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first two days.
      - name: has_workflow_enabled_first_month_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first month.
      - name: has_workflow_enabled_first_two_months_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first two months.
      - name: has_workflow_enabled_first_six_months_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first six months.
      - name: has_workflow_enabled_first_three_months_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first three months.
      - name: has_workflow_enabled_first_two_weeks_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first two weeks.
      - name: has_workflow_enabled_first_two_days_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first two days.
      - name: has_workflow_enabled_first_year_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first year.
      - name: lifetime_value_activated
        description:
          The average revenue generated by users who first installed in the
          given week and are activated.
      - name: activation_incremental_pct
        description:
          The percentage of users who first installed in the given week and
          are activated, compared to only enabling a workflow.
      - name: workflow_enabling_cohort_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow, compared to the cohort size.

      - name: has_workflow_first_year_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first year.
      - name: ever_paid_plan_count
        description:
          The number of users who first installed in the given week and have
          ever paid for a plan.
      - name: has_workflow_first_week_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first week.
      - name: has_workflow_first_week_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first week.
      - name: has_workflow_first_year_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first year.
      - name: paid_plan_first_day_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first day.
      - name: paid_plan_first_month_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first month.
      - name: paid_plan_first_three_months_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first three months.
      - name: paid_plan_first_two_days_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first two days.
      - name: ever_paid_plan_pct
        description:
          The percentage of users who first installed in the given week and
          have ever paid for a plan.
      - name: has_workflow_first_day_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first day.
      - name: paid_plan_first_week_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first week.
      - name: has_workflow_first_two_days_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first two days.
      - name: paid_plan_first_year_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first year.
      - name: has_workflow_first_three_days_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first three days.
      - name: paid_plan_first_two_weeks_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first two weeks.
      - name: has_workflow_first_two_months_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first two months.
      - name: paid_plan_first_two_weeks_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first two weeks.
      - name: paid_plan_first_two_months_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first two months.
      - name: has_workflow_first_day_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first day.
      - name: paid_plan_first_six_months_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first six months.
      - name: has_workflow_first_six_months_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first six months.
      - name: has_workflow_first_two_days_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first two days.
      - name: paid_plan_first_week_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first week.
      - name: has_workflow_first_month_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first month.
      - name: paid_plan_first_six_months_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first six months.
      - name: has_workflow_first_three_days_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first three days.
      - name: has_workflow_first_two_weeks_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first two weeks.
      - name: has_workflow_first_three_months_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first three months.
      - name: has_workflow_first_month_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first month.
      - name: paid_plan_first_day_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first day.
      - name: paid_plan_first_year_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first year.
      - name: paid_plan_first_month_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first month.
      - name: has_workflow_first_two_months_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first two months.
      - name: has_workflow_first_two_weeks_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first two weeks.
      - name: has_workflow_first_three_months_count
        description:
          The number of users who first installed in the given week and have
          enabled a workflow within the first three months.
      - name: paid_plan_first_three_days_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first three days.
      - name: paid_plan_first_three_months_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first three months.
      - name: paid_plan_first_three_days_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first three days.
      - name: paid_plan_first_two_months_pct
        description:
          The percentage of users who first installed in the given week and
          have paid for a plan within the first two months.
      - name: paid_plan_first_two_days_count
        description:
          The number of users who first installed in the given week and have
          paid for a plan within the first two days.
      - name: has_workflow_first_six_months_pct
        description:
          The percentage of users who first installed in the given week and
          have enabled a workflow within the first six months.
      - name: last_period_avg_constellation_cohort_size
        description: The number of new installed Shops but are not in the Mesa
          segment.
      - name: shopify_shopify_plus_plan_count
        description: The number of users who have a Shopify Plus plan.
      - name: avg_constellation_mql_count
        description: The number of MQLs who are not in the Mesa segment averaged over trailing 4 weeks.
      - name: shopify_trial_plan_count
        description: The number of users who have a trial plan.
      - name: shopify_trial_plan_pct
        description: The percentage of users who have a trial plan.
      - name: shopify_professional_plan_pct
        description: The percentage of users who have a Professional plan.
      - name: shopify_professional_plan_count
        description: The number of users who have a Professional plan.
      - name: shopify_basic_plan_pct
        description: The percentage of users who have a Basic plan.
      - name: shopify_basic_plan_count
        description: The number of Mesa users who have a Basic plan.
      - name: avg_constellation_mql_count_growth
        description: The percentage of non-MESA MQL shops in the constellation for the given week compared to the week prior.
      - name: last_period_avg_constellation_cohort_size
        description: The rolling average number of non-MESA new customer app installs in the prior week.
      - name: shopify_unlimited_plan_pct
        description: The percentage of users who have an Unlimited plan.
      - name: mesa_growth_rate
        description: The percentage of new customer MESA installs for the given week compared to the week prior.
      - name: mql_growth_rate
        description: The percentage of new customer MQL MESA installs for the given week compared to the week prior.
      - name: shopify_unlimited_plan_count
        description: The number of users who have an Unlimited plan
      - name: prior_one_week_mql_count
        description: The number of MQLs in the prior week.
      - name: avg_constellation_cohort_size
        description: The number of non-MESA MQL shops in the constellation averaged over the last 4 weeks.
      - name: shopify_shopify_plus_plan_pct
        description: The percentage of users who have a Shopify Plus plan.
      - name: mql_count
        description: The number of MQLs that installed MESA in the given week.
      - name: avg_constellation_cohort_size_growth
        description: The percentage of non-MESA new customer app installs averaged over the last 4 weeks.
      - name: prior_one_week_new_customer_count
        description: The number of new customer MESA app installs in the prior week.
      - name: normalized_customer_count
        description: The number of new customer MESA installs for the given week normalized by the number of growth rate of the constellation.
      - name: normalized_customer_growth
        description: The grwoth rate of MESA normalized by the growth rate of the constellation.
      - name: normalized_mql_count
        description: The number of MQLs in the given week normalized by the number of growth rate of the constellation.
      - name: last_period_avg_constellation_mql_count
        description: Last week's number of MQLs who are not in the Mesa segment averaged over trailing 4 weeks.
      - name: avg_constellation_mql_pct
        description: The percentage of MQLs who are not in the Mesa segment averaged over trailing 4 weeks.
      - name: normalized_mql_growth
        description: The growth rate of MQLs normalized by the growth rate of the constellation.
